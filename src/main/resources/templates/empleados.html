<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dash Flow - Control de Finanzas</title>

    <!-- Icons de Google -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp">

    <!-- CSS Externo -->
    <link rel="stylesheet" th:href="@{/css/pedidos.css}">

    <script th:src="@{/js/script.js}"></script>
</head>

<body>

    <div class="container-JE">

        <!-- INICIO DE LA BARRA DE NAVEGACIÓN -->

        <aside class="aside-JE">
            <div class="top-JE">

                <div class="logo-JE">
                    <img class="img-JE" th:src="@{/images/logo-dashboard.png}" alt="logo">
                    <h2 class="h2-JE">DASH <span class="peligro-JE">FLOW</span></h2>
                </div>

                <div class="close-JE" id="close-btn-JE">
                    <span class="material-icons-sharp">close</span>
                </div>

            </div>


            <div class="sidebar-JE">

                <a th:href="@{/dashboard}" class="hipervinculo-JE">
                    <span class="material-icons-sharp">dashboard</span>
                    <h3 class="h3-JE">Dashboard</h3>
                </a>

                <a th:href="@{/cuenta}" class="hipervinculo-JE">
                    <span class="material-icons-sharp">person_outline</span>
                    <h3 class="h3-JE">Cuenta</h3>
                </a>

                <a th:href="@{/productos}" class="hipervinculo-JE">
                    <span class="material-icons-sharp">inventory</span>
                    <h3 class="h3-JE">Productos</h3>
                </a>

                <a th:href="@{/ingresos}" class="hipervinculo-JE">
                    <span class="material-icons-sharp">insights</span>
                    <h3 class="h3-JE">Flujo de Ingresos</h3>
                </a>

                <a th:href="@{/pedidos}" class="hipervinculo-JE">
                    <span class="material-icons-sharp">list_alt</span>
                    <h3 class="h3-JE">Pedidos</h3>
                    <span class="message-count-danger-JE">26</span>
                </a>

                <a th:href="@{/empleados}" class="hipervinculo-JE active-JE">
                    <span class="material-icons-sharp">badge</span>
                    <h3 class="h3-JE">Empleados</h3>
                </a>

                <a th:href="@{/tiers}" class="hipervinculo-JE">
                    <span class="material-icons-sharp">workspace_premium</span>
                    <h3 class="h3-JE">Tiers</h3>
                    <span class="message-count-success-JE">Free</span>
                </a>

                <a th:href="@{/reportes}" class="hipervinculo-JE">
                    <span class="material-icons-sharp">error_outline</span>
                    <h3 class="h3-JE">Reportes</h3>
                </a>

                <form id="logoutForm" th:action="@{/logout}" method="post" style="display:none;"></form>
                <a onclick="document.getElementById('logoutForm').submit();" class="hipervinculo-JE"
                    style="cursor: pointer;">
                    <span class="material-icons-sharp">logout</span>
                    <h3 class="h3-JE">Salir</h3>
                </a>

            </div>
        </aside>

        <!-- FIN DE LA BARRA DE NAVEGACIÓN -->

        <main class="main-JE">

            <div class="page-header-JE">
                <h1 class="h1-JE">Gestión de Empleados</h1>
            </div>

            <div class="products-tabs-JE">
                <div class="tab-header-JE">
                    <div class="tab-item-JE active-tab-JE" data-tab="dashboard">
                        <span class="material-icons-sharp">analytics</span>
                        <h3 class="h3-JE">Dashboard</h3>
                    </div>
                    <div class="tab-item-JE" data-tab="employees">
                        <span class="material-icons-sharp">group</span>
                        <h3 class="h3-JE">Lista de Empleados</h3>
                    </div>
                    <div class="tab-item-JE" data-tab="form">
                        <span class="material-icons-sharp">person_add</span>
                        <h3 class="h3-JE">Agregar/Editar Empleado</h3>
                    </div>
                </div>

                <div class="tab-content-JE">

                    <div class="tab-pane-JE active-pane-JE" id="dashboard">

                        <div class="stats-grid-JE">
                            <div class="stat-card-JE">
                                <div class="stat-icon-JE">
                                    <span class="material-icons-sharp">people</span>
                                </div>
                                <div class="stat-content-JE">
                                    <h3 class="h3-JE">Total Empleados</h3>
                                    <h2 class="h2-JE">85</h2>
                                    <p class="p-JE exito-JE">+5 nuevos este año</p>
                                </div>
                            </div>

                            <div class="stat-card-JE">
                                <div class="stat-icon-JE">
                                    <span class="material-icons-sharp">work</span>
                                </div>
                                <div class="stat-content-JE">
                                    <h3 class="h3-JE">Activos</h3>
                                    <h2 class="h2-JE">78</h2>
                                    <p class="p-JE exito-JE">91.8% de la plantilla</p>
                                </div>
                            </div>

                            <div class="stat-card-JE">
                                <div class="stat-icon-JE">
                                    <span class="material-icons-sharp">schedule</span>
                                </div>
                                <div class="stat-content-JE">
                                    <h3 class="h3-JE">Vacaciones</h3>
                                    <h2 class="h2-JE">7</h2>
                                    <p class="p-JE advertencia-JE">Programados para el mes</p>
                                </div>
                            </div>

                            <div class="stat-card-JE">
                                <div class="stat-icon-JE">
                                    <span class="material-icons-sharp">person_off</span>
                                </div>
                                <div class="stat-content-JE">
                                    <h3 class="h3-JE">Inactivos/Ausentes</h3>
                                    <h2 class="h2-JE">3</h2>
                                    <p class="p-JE peligro-JE">Revisar</p>
                                </div>
                            </div>
                        </div>

                        <div class="featured-products-JE">
                            <h2 class="h2-JE">Departamentos Principales</h2>

                            <div class="featured-grid-JE">

                                <div class="featured-card-JE">
                                    <div class="featured-header-JE">
                                        <div class="featured-badge-JE week-JE">
                                            <span class="material-icons-sharp">bar_chart</span>
                                            Mayor Empleados
                                        </div>
                                    </div>
                                    <div class="product-image-JE">
                                        <img src="/placeholder.svg?height=120&width=120" alt="Ventas">
                                    </div>
                                    <div class="product-info-JE">
                                        <h3 class="h3-JE">Ventas</h3>
                                        <p class="p-JE text-muted-JE">Rol: Comercial</p>
                                        <div class="product-stats-JE">
                                            <div class="stat-JE">
                                                <span class="material-icons-sharp">group</span>
                                                <span>25 empleados</span>
                                            </div>
                                            <div class="stat-JE">
                                                <span class="material-icons-sharp">trending_up</span>
                                                <span>+10% rendimiento</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="featured-card-JE">
                                    <div class="featured-header-JE">
                                        <div class="featured-badge-JE month-JE">
                                            <span class="material-icons-sharp">support_agent</span>
                                            Alta Interacción
                                        </div>
                                    </div>
                                    <div class="product-image-JE">
                                        <img src="/placeholder.svg?height=120&width=120" alt="Atención al Cliente">
                                    </div>
                                    <div class="product-info-JE">
                                        <h3 class="h3-JE">Atención al Cliente</h3>
                                        <p class="p-JE text-muted-JE">Rol: Soporte</p>
                                        <div class="product-stats-JE">
                                            <div class="stat-JE">
                                                <span class="material-icons-sharp">group</span>
                                                <span>18 empleados</span>
                                            </div>
                                            <div class="stat-JE">
                                                <span class="material-icons-sharp">star</span>
                                                <span>4.8/5 satisfacción</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>

                    <div class="tab-pane-JE" id="employees">

                        <div class="filters-section-JE">
                            <div class="search-box-JE">
                                <span class="material-icons-sharp">search</span>
                                <input type="text" placeholder="Buscar empleados..." id="searchInput">
                            </div>

                            <div class="filters-JE">
                                <select id="departmentFilter">
                                    <option value="">Todos los departamentos</option>
                                    <option value="ventas">Ventas</option>
                                    <option value="marketing">Marketing</option>
                                    <option value="recursos_humanos">Recursos Humanos</option>
                                    <option value="operaciones">Operaciones</option>
                                </select>

                                <select id="statusFilter">
                                    <option value="">Todos los estados</option>
                                    <option value="activo">Activo</option>
                                    <option value="vacaciones">Vacaciones</option>
                                    <option value="ausente">Ausente</option>
                                    <option value="inactivo">Inactivo</option>
                                </select>

                                <button class="btn-secondary-JE" id="clearFilters">
                                    <span class="material-icons-sharp">clear</span>
                                    Limpiar
                                </button>
                            </div>
                        </div>

                        <div class="products-table-JE">
                            <table id="employeesTable">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Email</th>
                                        <th>Rol</th>
                                        <th>Departamento</th>
                                        <th>Salario</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="employeesTableBody">
                                    <!-- Los datos se cargarán dinámicamente desde el servidor -->
                                    <tr th:each="emp : ${empleados}">
                                        <td th:text="${emp.nombre}"></td>
                                        <td th:text="${emp.email}"></td>
                                        <td th:text="${emp.rol.nombreRol}"></td>
                                        <td th:text="${emp.departamento.nombre}"></td>
                                        <td th:text="${emp.salario}"></td>
                                        <td th:text="${emp.estado.nombre}"></td>
                                        <td>
                                            <a th:href="@{/empleados/editarEmpleado(id=${emp.id})}"
                                                class="btn-action-JE edit-btn">
                                                <span class="material-icons-sharp">edit</span>
                                            </a>
                                            <a th:href="@{/empleados/eliminarEmpleado(id=${emp.id})}"
                                                class="btn-action-JE delete-btn">
                                                <span class="material-icons-sharp">delete</span>
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="pagination-JE">
                            <button class="pagination-btn-JE" id="prevPage">
                                <span class="material-icons-sharp">chevron_left</span>
                            </button>
                            <div class="pagination-info-JE">
                                <span>Página <span id="currentPage">1</span> de <span id="totalPages">5</span></span>
                            </div>
                            <button class="pagination-btn-JE" id="nextPage">
                                <span class="material-icons-sharp">chevron_right</span>
                            </button>
                        </div>

                        <div class="bulk-actions-JE" id="bulkActions" style="display: none;">
                            <div class="bulk-info-JE">
                                <span id="selectedCount">0</span> empleados seleccionados
                            </div>
                            <div class="bulk-buttons-JE">
                                <button class="btn-secondary-JE" id="bulkActivate">
                                    <span class="material-icons-sharp">check_circle</span>
                                    Activar
                                </button>
                                <button class="btn-secondary-JE" id="bulkDeactivate">
                                    <span class="material-icons-sharp">cancel</span>
                                    Desactivar
                                </button>
                                <button class="btn-danger-JE" id="bulkDelete">
                                    <span class="material-icons-sharp">delete</span>
                                    Eliminar
                                </button>
                            </div>
                        </div>

                    </div>

                    <div class="tab-pane-JE" id="form">

                        <div class="form-header-JE">
                            <h2 class="h2-JE" id="formTitle">Agregar Nuevo Empleado</h2>
                            <button class="btn-secondary-JE" id="cancelForm">
                                <span class="material-icons-sharp">close</span>
                                Cancelar
                            </button>
                        </div>

                        <form class="product-form-JE" id="employeeForm" th:action="@{/empleados/guardarEmpleado}"
                            th:object="${empleado}" method="post">
                            <div class="form-section-JE">
                                <h3 class="h3-JE">Información Personal</h3>

                                <input type="hidden" th:field="*{id}" />
                                <div class="form-group-JE" style="margin-bottom: 20px;">
                                    <label for="employeeName">Nombre *</label>
                                    <input type="text" id="employeeName" th:field="*{nombre}" th:readonly="${empleado.id != null}" required>
                                </div>

                                <div class="form-row-JE">
                                    <div class="form-group-JE">
                                        <label for="employeeEmail">Email *</label>
                                        <input type="email" id="employeeEmail" th:field="*{email}" name="username" th:readonly="${empleado.id != null}" required>
                                    </div>

                                    <div class="form-group-JE">
                                        <label for="employeePassword">Contraseña *</label>
                                        <input type="password" id="employeePassword" th:field="*{clave}" name="password" th:readonly="${empleado.id != null}" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section-JE">
                                <h3 class="h3-JE">Información Laboral</h3>

                                <div class="form-row-JE">
                                    <div class="form-group-JE">
                                        <label for="employeeHireDate">Fecha de Contratación *</label>
                                        <input type="date" id="employeeHireDate" th:field="*{fechaContratacion}"
                                            required>
                                        <small th:text="${empleado.fechaContratacion}" class="p-JE" style="margin-left: 5px;"></small>
                                    </div>

                                    <div class="form-group-JE">
                                        <label for="employeeFinalDate">Fecha de Finalización</label>
                                        <input type="date" id="employeeFinalDate" th:field="*{fechaDespido}">
                                        <small th:text="${empleado.fechaDespido}" class="p-JE" style="margin-left: 5px;"></small>
                                    </div>
                                </div>

                                <div class="form-row-JE">
                                    <div class="form-group-JE">
                                        <label for="employeeStatus">Estado *</label>
                                        <select id="employeeStatus" th:field="*{estado}" required>
                                            <option value="">Seleccionar estado</option>
                                            <option th:each="e : ${estados}" th:value="${e}" th:text="${e.nombre}">
                                            </option>
                                        </select>
                                    </div>

                                    <div class="form-group-JE">
                                        <label for="employeeDepartment">Departamento *</label>
                                        <select id="employeeDepartment" th:field="*{departamento}" required>
                                            <option value="">Seleccionar departamento</option>
                                            <option th:each="depto : ${departamentos}" th:value="${depto}"
                                                th:text="${depto.nombre}">Ventas</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row-JE">
                                    <div class="form-group-JE">
                                        <label for="employeeSalary">Salario Base</label>
                                        <div class="input-with-icon-JE">
                                            <span class="material-icons-sharp">attach_money</span>
                                            <input type="number" id="employeeSalary" th:field="*{salario}" step="0.01">
                                        </div>
                                    </div>

                                    <div class="form-group-JE">
                                        <label for="employeeRole">Rol de Acceso *</label>
                                        <select id="employeeRole" th:field="*{rol.id}" th:readonly="${empleado.id != null}" required>
                                            <option value="">Seleccionar rol</option>
                                            <option th:each="rol : ${roles}" th:value="${rol.id}"
                                                th:text="${rol.nombreRol}"></option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions-JE">
                                <button type="button" class="btn-secondary-JE" id="resetForm">
                                    <span class="material-icons-sharp">refresh</span>
                                    Limpiar
                                </button>
                                <button type="submit" class="btn-primary-JE">
                                    <span class="material-icons-sharp">save</span>
                                    <span id="submitText">Guardar Empleado</span>
                                </button>
                            </div>
                        </form>

                    </div>

                </div>
            </div>

        </main>

        <div class="right-JE">

            <div class="top-JE">
                <button id="menu-btn-JE">
                    <span class="material-icons-sharp">menu</span>
                </button>
                <div class="theme-toggler-JE">
                    <span class="material-icons-sharp active-JE">light_mode</span>
                    <span class="material-icons-sharp">dark_mode</span>
                </div>
                <div class="profile-JE">
                    <div class="info-JE">
                        <p class="p-JE">Hey <b class="b-JE" th:text="${usuarioInfo.nombre}"></b></p>
                        <small class="small-JE text-muted-JE" th:text="${usuarioInfo.rol}"></small>
                    </div>
                    <div class="profile-photo-JE">
                        <img class="img-JE" th:src="@{/images/profile-1.jpg}" alt="Foto de Perfil">
                    </div>
                </div>
            </div>

            <div class="quick-actions-JE">
                <h2 class="h2-JE">Acciones Rápidas</h2>

                <button class="quick-action-btn-JE" id="addEmployeeBtn">
                    <span class="material-icons-sharp">person_add</span>
                    <div class="action-content-JE">
                        <h4 class="h4-JE">Nuevo Empleado</h4>
                        <p class="p-JE text-muted-JE">Añadir nuevo miembro al equipo</p>
                    </div>
                </button>

                <button class="quick-action-btn-JE" id="importEmployeesBtn">
                    <span class="material-icons-sharp">upload</span>
                    <div class="action-content-JE">
                        <h4 class="h4-JE">Importar CSV</h4>
                        <p class="p-JE text-muted-JE">Cargar datos de empleados masivamente</p>
                    </div>
                </button>

                <button class="quick-action-btn-JE" id="exportEmployeesBtn">
                    <span class="material-icons-sharp">download</span>
                    <div class="action-content-JE">
                        <h4 class="h4-JE">Exportar Datos</h4>
                        <p class="p-JE text-muted-JE">Descargar lista de empleados</p>
                    </div>
                </button>
            </div>

            <div class="inventory-alerts-JE">
                <h2 class="h2-JE">Alertas de Personal</h2>

                <div class="alert-item-JE critical-JE">
                    <div class="alert-icon-JE">
                        <span class="material-icons-sharp">error</span>
                    </div>
                    <div class="alert-content-JE">
                        <h4 class="h4-JE">Contratos por Vencer</h4>
                        <p class="p-JE">2 contratos en los próximos 30 días</p>
                        <button class="alert-action-JE">Revisar</button>
                    </div>
                </div>

                <div class="alert-item-JE warning-JE">
                    <div class="alert-icon-JE">
                        <span class="material-icons-sharp">warning</span>
                    </div>
                    <div class="alert-content-JE">
                        <h4 class="h4-JE">Evaluaciones Pendientes</h4>
                        <p class="p-JE">5 evaluaciones de desempeño atrasadas</p>
                        <button class="alert-action-JE">Gestionar</button>
                    </div>
                </div>

                <div class="alert-item-JE info-JE">
                    <div class="alert-icon-JE">
                        <span class="material-icons-sharp">info</span>
                    </div>
                    <div class="alert-content-JE">
                        <h4 class="h4-JE">Próximos Cumpleaños</h4>
                        <p class="p-JE">¡2 empleados cumplen años esta semana!</p>
                        <button class="alert-action-JE">Ver Detalles</button>
                    </div>
                </div>
            </div>

        </div>

    </div>

    <div class="modal-JE" id="confirmModal">
        <div class="modal-content-JE">
            <div class="modal-header-JE">
                <h3 class="h3-JE" id="modalTitle">Confirmar Acción</h3>
                <span class="modal-close-JE" id="modalClose">
                    <span class="material-icons-sharp">close</span>
                </span>
            </div>
            <div class="modal-body-JE">
                <p class="p-JE" id="modalMessage">¿Estás seguro de que deseas realizar esta acción?</p>
            </div>
            <div class="modal-footer-JE">
                <button class="btn-secondary-JE" id="modalCancel">Cancelar</button>
                <button class="btn-danger-JE" id="modalConfirm">Confirmar</button>
            </div>
        </div>
    </div>

    <script th:src="@{/js/empleados.js}"></script>

</body>

</html>